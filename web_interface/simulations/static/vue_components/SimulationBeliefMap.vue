<template id="template">
    <div class="card">
        <div class="card-content" style="margin:0 auto" v-if="loaded">
            <span class="card-title">Belief Map</span>

            <div v-for="row in height" class="map_row">
                <div v-for="col in width" class="map_cell">
                    <p v-if="get_data(row-1, col-1).length > 0">
                        <img v-if="get_data(row-1, col-1)[0].type==='drone'" style="width:39px; vertical-align: baseline" src="data:image/svg+xml;base64,PHN2ZyBpZD0iQ2FwYV8xIiBlbmFibGUtYmFja2dyb3VuZD0ibmV3IDAgMCA1MTIgNTEyIiBoZWlnaHQ9IjUxMiIgdmlld0JveD0iMCAwIDUxMiA1MTIiIHdpZHRoPSI1MTIiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGc+PGNpcmNsZSBjeD0iNDIyIiBjeT0iOTAiIHI9IjEwIi8+PGNpcmNsZSBjeD0iNDIyIiBjeT0iNDIyIiByPSIxMCIvPjxjaXJjbGUgY3g9IjkwIiBjeT0iOTAiIHI9IjEwIi8+PGNpcmNsZSBjeD0iOTAiIGN5PSI0MjIiIHI9IjEwIi8+PHBhdGggZD0ibTQ5NC45MjkgMzM0LjkyOS00NS4zNTQgNDUuMzU0Yy04LjExMS01LjM4Ny0xNy42MjEtOC4yODMtMjcuNTc1LTguMjgzLTIuMzc3IDAtNC43MzcuMTgxLTcuMDY2LjUxMWwtODEuMTktODEuMTkxIDcuMDY1LTc3LjcwNiA3NC4xMjYtNzQuMTI2YzIuMzMxLjMzMSA0LjY5LjUxMiA3LjA2Ni41MTIgOS45NTQgMCAxOS40NjQtMi44OTYgMjcuNTc1LTguMjgzbDQ1LjM1NCA0NS4zNTRjMy45MDUgMy45MDUgMTAuMjM1IDMuOTA2IDE0LjE0MyAwIDMuOTA1LTMuOTA1IDMuOTA1LTEwLjIzNyAwLTE0LjE0MmwtNDUuMzU0LTQ1LjM1NWM1LjM4Ni04LjExIDguMjgxLTE3LjYyIDguMjgxLTI3LjU3NCAwLTI3LjU3LTIyLjQzLTUwLTUwLTUwLTkuOTU0IDAtMTkuNDY0IDIuODk2LTI3LjU3NSA4LjI4M2wtNDUuMzUzLTQ1LjM1NGMtMy45MDQtMy45MDUtMTAuMjM0LTMuOTA1LTE0LjE0MyAwLTMuOTA1IDMuOTA1LTMuOTA1IDEwLjIzNyAwIDE0LjE0Mmw0NS4zNTQgNDUuMzU1Yy01LjM4NyA4LjExMS04LjI4MyAxNy42Mi04LjI4MyAyNy41NzQgMCAyLjM3OC4xODEgNC43MzkuNTExIDcuMDY2bC00MS4zODUgNDEuMzg0Yy0yLjA4MS0yLjI4NS00LjM1Ni00LjM5Ny02LjgxMS02LjI3MS0yMi42MTgtMTcuMjU3LTQ1LjM3OC0yNi4wODktNjguMzE1LTI2LjA4OS0yMi45NDkgMC00Ni4wNzYgOC44NDItNjkuNDIgMjYuOTMtMi4wNzIgMS42MDMtNC4wMTYgMy4zOTEtNS44MDggNS4zMjhsLTQxLjI4NC00MS4yODNjLjMzMi0yLjMyOS41MTItNC42ODguNTEyLTcuMDY1IDAtOS45NTQtMi44OTYtMTkuNDY0LTguMjgzLTI3LjU3NWw0NS4zNTQtNDUuMzU1YzMuOTA1LTMuOTA1IDMuOTA1LTEwLjIzNyAwLTE0LjE0Mi0zLjkwNi0zLjkwNS0xMC4yMzYtMy45MDUtMTQuMTQzIDBsLTQ1LjM1NCA0NS4zNTRjLTguMTEtNS4zODYtMTcuNjItOC4yODItMjcuNTc0LTguMjgyLTI3LjU3IDAtNTAgMjIuNDMtNTAgNTAgMCA5Ljk1NCAyLjg5NiAxOS40NjMgOC4yODMgMjcuNTc1bC00NS4zNTQgNDUuMzU0Yy0zLjkwNSAzLjkwNS0zLjkwNSAxMC4yMzcgMCAxNC4xNDIgMy45MDYgMy45MDUgMTAuMjM2IDMuOTA1IDE0LjE0MyAwbDQ1LjM1NC00NS4zNTRjOC4xMTEgNS4zODcgMTcuNjIgOC4yODMgMjcuNTc0IDguMjgzIDIuMzc3IDAgNC43MzctLjE4MSA3LjA2Ni0uNTExbDc0LjE0IDc0LjE0IDcuMDUxIDc3LjY5Mi04MS4xOTEgODEuMTkxYy0yLjMzMS0uMzMxLTQuNjktLjUxMi03LjA2Ni0uNTEyLTkuOTU0IDAtMTkuNDY0IDIuODk2LTI3LjU3NSA4LjI4M2wtNDUuMzU0LTQ1LjM1NGMtMy45MDQtMy45MDUtMTAuMjM0LTMuOTA1LTE0LjE0MyAwLTMuOTA1IDMuOTA1LTMuOTA1IDEwLjIzNyAwIDE0LjE0Mmw0NS4zNTQgNDUuMzU1Yy01LjM4NiA4LjExMS04LjI4MiAxNy42Mi04LjI4MiAyNy41NzQgMCAyNy41NyAyMi40MyA1MCA1MCA1MCA5Ljk1NCAwIDE5LjQ2NC0yLjg5NiAyNy41NzUtOC4yODNsNDUuMzU0IDQ1LjM1NGMxLjk1MyAxLjk1MyA0LjUxMiAyLjkyOSA3LjA3MSAyLjkyOXM1LjExOC0uOTc3IDcuMDcxLTIuOTI5YzMuOTA1LTMuOTA1IDMuOTA1LTEwLjIzNyAwLTE0LjE0MmwtNDUuMzU0LTQ1LjM1NWM1LjM4OC04LjExIDguMjgzLTE3LjYyIDguMjgzLTI3LjU3NCAwLTIuMzc2LS4xODEtNC43MzYtLjUxMi03LjA2Nmw0NS45MDMtNDUuOTAzYzEuNDQ1IDkuMDkgNy4wMDQgMTcuMDU4IDE1LjE2NSAyMS41NzcgMTcuMDQ2IDkuNDM4IDM1LjY2MSAxNS4zMTggNTUuNTM4IDE1LjMxOCAxOS42MzYgMCAzOC4wNC01LjcyNCA1NS4zNS0xNS4zMTggOC4xNTEtNC41MTQgMTMuNzA3LTEyLjQ4MSAxNS4xNi0yMS41ODJsNDUuOTA3IDQ1LjkwOGMtLjMzMSAyLjMzLS41MTIgNC42OS0uNTEyIDcuMDY2IDAgOS45NTQgMi44OTYgMTkuNDYzIDguMjgzIDI3LjU3NWwtNDUuMzU0IDQ1LjM1NGMtMy45MDUgMy45MDUtMy45MDUgMTAuMjM3IDAgMTQuMTQyIDMuOTA2IDMuOTA1IDEwLjIzNiAzLjkwNSAxNC4xNDMgMGw0NS4zNTQtNDUuMzU0YzguMTEyIDUuMzg3IDE3LjYyMSA4LjI4MyAyNy41NzUgOC4yODMgMjcuNTcgMCA1MC0yMi40MyA1MC01MCAwLTkuOTU0LTIuODk2LTE5LjQ2NC04LjI4My0yNy41NzVsNDUuMzU0LTQ1LjM1NWMzLjkwNS0zLjkwNSAzLjkwNS0xMC4yMzcgMC0xNC4xNDItMy45MDYtMy45MDQtMTAuMjM2LTMuOTA0LTE0LjE0Mi4wMDF6bS03Mi45MjktMjc0LjkyOWMxNi41NDIgMCAzMCAxMy40NTggMzAgMzAgMCA4LjAwNy0zLjEyMiAxNS41NC04Ljc5MSAyMS4yMDgtNS42NjkgNS42Ny0xMy4yMDEgOC43OTItMjEuMjA5IDguNzkyLTE2LjU3IDAtMzAtMTMuNDMxLTMwLTMwIDAtMTYuNTUyIDEzLjQyOS0zMCAzMC0zMHptLTQxLjcwMiA1Ny41NjVjMy43MTUgNS42MTEgOC41MjkgMTAuNDI1IDE0LjEzNiAxNC4xMzlsLTUwLjc5NiA1MC43OTYuNTIyLTUuNzM4Yy42MzMtNi45ODgtLjIyNi0xMy45ODEtMi40ODQtMjAuNTc0em0tMjkwLjI5OCAyLjQzNWMtMTYuNTQ3IDAtMzAtMTMuNDMyLTMwLTMwIDAtMTYuNTQyIDEzLjQ1OC0zMCAzMC0zMCAxNi41NDcgMCAzMCAxMy40MzIgMzAgMzAgMCAxNi41NzEtMTMuNDM3IDMwLTMwIDMwem03Ny44NTIgNTYuNzYxYy4xNjYgMS44MTcuMzQyIDMuNzQyLjUyNSA1Ljc1M2wtNTAuODExLTUwLjgxMWM1LjYxMS0zLjcxNSAxMC40MjUtOC41MjkgMTQuMTM4LTE0LjEzNmwzOC41NjEgMzguNTYxYy0yLjIxOSA2LjU5My0zLjA1MyAxMy42MDYtMi40MTMgMjAuNjMzem0tNzcuODUyIDI3NS4yMzljLTE2LjU0MiAwLTMwLTEzLjQ1OC0zMC0zMCAwLTE2LjU2OCAxMy40MjktMzAgMzAtMzAgMTYuNjM3IDAgMzAgMTMuNSAzMCAzMCAwIDE2LjU2OS0xMy40MjkgMzAtMzAgMzB6bTQxLjcwMy01Ny41NjVjLTMuNzE1LTUuNjExLTguNTI5LTEwLjQyNS0xNC4xMzYtMTQuMTM5bDYzLjA1Mi02My4wNTJjMS42NzMgMTguMzc0IDIuMDk5IDIzLjA4MSAyLjM1NyAyNS45MTl6bTEzNC4yOTctOS4xMjRjLTYuNjQ2LjgxMi0xMy4zMzEuODA1LTIwLS4wMjJ2LTQ5LjI4OWMwLTUuNTE0IDQuNDg2LTEwIDEwLTEwczEwIDQuNDg2IDEwIDEwem01OC4yNDEtMjEwLjM1Ni0xNy4yOTkgMTkwLjI1MmMtLjMwOSAzLjM2OS0yLjE5OSA2LjI1LTUuMTkgNy45MDYtNS4zNCAyLjk2LTEwLjU1OSA1LjM1OS0xNS43NTIgNy4yNzJ2LTQ0LjM4NWMwLTE2LjU0Mi0xMy40NTgtMzAtMzAtMzBzLTMwIDEzLjQ1OC0zMCAzMHY0NC4zNDljLTUuMjQxLTEuOTI2LTEwLjUwOC00LjMzMi0xNS43NTUtNy4yMzctMi45OS0xLjY1Ni00Ljg4LTQuNTI2LTUuMTg2LTcuODU0LS4wMDktLjEwNC0xNi42NjEtMTgzLjQyMy0xNy4yOTEtMTkwLjMxNS0uOTQ5LTEwLjQxMyAzLjQ5Ny0yMC4yNTkgMTEuMDU3LTI2LjEwOSA0LjcyMy0zLjY2IDkuNDQ2LTYuODggMTQuMTM2LTkuNjY3bDEzLjEgMTE3LjkzNmMuNjA2IDUuNDY3IDUuNTI3IDkuNDQ1IDExLjA0MyA4LjgzNSA1LjQ4OC0uNjEgOS40NDQtNS41NTQgOC44MzQtMTEuMDQzbC0xMy44NDgtMTI0LjY3YzguMDcxLTIuNzM5IDE2LjA2Mi00LjEyNyAyNC4wNDEtNC4xMjcgNy45MTcgMCAxNS44MjUgMS4zNjcgMjMuNzg5IDQuMDY0bC04Ljg4OCA4MC4wMDZjLS42MSA1LjQ4OSAzLjM0NSAxMC40MzMgOC44MzQgMTEuMDQzIDUuNTExLjYwOCAxMC40MzYtMy4zNjMgMTEuMDQzLTguODM1bDguMTM4LTczLjI1M2M0LjMwNyAyLjU3NSA4LjY2NCA1LjU0NCAxMy4xMzYgOC45NTYgOC4zNzYgNi4zOTQgMTMuMDAyIDE2LjQ2NCAxMi4wNTggMjYuODc2em01Ni4wNTUgMjE5LjQ3OS01MS4yNjctNTEuMjY3IDIuMzU3LTI1LjkxOSA2My4wNDkgNjMuMDVjLTUuNjExIDMuNzE1LTEwLjQyNSA4LjUyOC0xNC4xMzkgMTQuMTM2em00MS43MDQgNTcuNTY2Yy0xNi41NDcgMC0zMC0xMy40MzItMzAtMzAgMC0xNi41NDEgMTMuNDA0LTMwIDMwLTMwIDE2LjU0NyAwIDMwIDEzLjQzMiAzMCAzMCAwIDE2LjU0Mi0xMy40NTggMzAtMzAgMzB6Ii8+PHBhdGggZD0ibTIwMi44NTkgNjMuMjc4Yy43NTgtLjcwNiAxOC45NzYtMTcuMjc4IDUzLjE0MS0xNy4yNzhzNTIuMzgzIDE2LjU3MiA1My4wOTUgMTcuMjMzYzMuOTkyIDMuODEyIDEwLjMyMyAzLjY2NyAxNC4xMzktLjMyOCAzLjgxMy0zLjk5NSAzLjY2Ny0xMC4zMjUtLjMyOC0xNC4xMzktLjk3NC0uOTI4LTI0LjMzOC0yMi43NjYtNjYuOTA2LTIyLjc2NnMtNjUuOTMyIDIxLjgzNy02Ni45MDUgMjIuNzY3Yy0zLjk5NSAzLjgxNC00LjE2NSAxMC4xNjYtLjM1MiAxNC4xNjEgMy44MTkgMy45OTkgMTAuMTI2IDQuMTU5IDE0LjExNi4zNXoiLz48cGF0aCBkPSJtMjkzLjk4NCA3Ni42NjRjLTMuNTgzLTIuNTE4LTE2LjgyOC0xMC42NjQtMzcuOTg0LTEwLjY2NC0yNC40NzYgMC0zOC4xNzEgMTAuODI0LTM5LjY1MSAxMi4wNTgtNC4yNDMgMy41MzYtNC44MzEgOS44NTMtMS4yOTUgMTQuMDk2IDMuNTM2IDQuMjQ0IDkuODI2IDQuODI3IDE0LjA2OSAxLjI5Mi4zNzYtLjMwNCA5LjQxMi03LjQ0NiAyNi44NzctNy40NDYgMTUuNzA2IDAgMjQuODIxIDUuODU2IDI2LjQ4OCA3LjAzLjAwMSAwIC4wMDEgMCAuMDAxLjAwMSA2LjUyNSA0Ljc2IDE1Ljg5MS4xNTMgMTUuODkxLTguMDgxIDAtMy4zOS0xLjY5OC02LjQ1MS00LjM4My04LjI3Ny0uMDAyLS4wMDItLjAwNi0uMDA0LS4wMDgtLjAwNi0uMDk4LS4wNjctLjE5Ny0uMTMyLS4yOTgtLjE5NS4wNjQuMDQxLjE3NS4xMS4yOTMuMTkyeiIvPjxwYXRoIGQ9Im0yOTMuOTg0IDc2LjY2NGMuMDAyLjAwMS4wMDQuMDAyLjAwNS4wMDQuMDAyLjAwMS4wMDUuMDAzLjAwNy4wMDUtLjAwNC0uMDAzLS4wMDgtLjAwNi0uMDEyLS4wMDl6Ii8+PGNpcmNsZSBjeD0iMjc2IiBjeT0iMjU2IiByPSIxMCIvPjwvZz48L3N2Zz4=" />
                        <span v-if="get_data(row-1, col-1)[0].type==='disaster'" style="font-size:39px" class="material-icons prefix">{{ get_data(row-1, col-1)[0].icon }}</span>
                    </p>
                </div>
            </div>
        </div>
    </div>
</template>

<script>
    module.exports = {
        name: "SimulationBeliefMap",
        template:"#template",
        props:["width", "height", "drones", "disaster"],
        data(){
            return{
                confidence:[],
                loaded:false,
            }
        },
        methods:{
            get_data(row, col){
                if( this.loaded )
                    return this.confidence[row][col].data;
                return []
            }
        },
        mounted(){
            let conf = this;

            for( var i=0; i< this.height; i++ ){
                row = [];
                for( var j=0; j < this.width; j++ ){
                    let data = [];

                    this.drones.forEach( (dr) => {
                        if( dr.position[0] === i && dr.position[1] === j ){
                            data.push({
                                type:"drone",
                                name:dr.name
                            });
                        }
                    });

                    this.disaster.points.forEach( (dis) => {
                        if(dis[0] === i && dis[1] === j){
                            data.push({
                                type:"disaster",
                                name:conf.disaster.config.name,
                                icon:conf.disaster.config.icon,
                            })
                        }
                    });

                    row.push({
                        data:data,
                    });
                }
                this.confidence.push(row);
            }

            this.loaded=true;
        }
    }
</script>